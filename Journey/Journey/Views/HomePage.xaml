<?xml version="1.0" encoding="utf-8"?>
<local:BasePage xmlns="http://xamarin.com/schemas/2014/forms"
                xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
                xmlns:local="clr-namespace:Journey.Views"
                xmlns:Controls="clr-namespace:Journey.Views.Controls"
                xmlns:resources="clr-namespace:Journey.Resources"
                x:Class="Journey.Views.HomePage">
    
    <ContentPage.Content>
        <Grid RowSpacing="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid Grid.Row="0" BackgroundColor="White" HeightRequest="75">
                <SearchBar Margin="0,5,0,0" HorizontalOptions="StartAndExpand" BackgroundColor="White" VerticalOptions="Center" WidthRequest="400" Focused="Handle_Focused" Placeholder="Search for friends" Text="{Binding SearchKeyword,Mode=TwoWay}" SearchCommand="{Binding OnSearchCommand}" />
                <Controls:LoadingControl IsVisible="{Binding IsLoading}" HorizontalOptions="End" VerticalOptions="Center" Margin="20,0" />
                <Image x:Name="img" HorizontalOptions="End" IsVisible="{Binding IsNotLoading}" VerticalOptions="Center" Margin="20,0" Source="loading.png" Style="{StaticResource IconStyle}" />
            </Grid>
            <!--<ListView x:Name="lst" CachingStrategy="RecycleElement" ItemsSource="{Binding PostsViewModels}" Grid.Row="1" SeparatorVisibility="None" ItemTemplate="{StaticResource PostTemplateSelector}" HasUnevenRows="true" BackgroundColor="#d3d3d3" ItemAppearing="Handle_ItemAppearing" IsPullToRefreshEnabled="true"
                      IsRefreshing="{Binding IsPullRefreshLoading}" RefreshAllowed="true" RefreshCommand="{Binding OnRefreshPostsCommand}">
                <ListView.Header>
                    <Grid RowSpacing="0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid Grid.Row="0" BackgroundColor="White" HeightRequest="60" Margin="0,5">
                            <Grid.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding OnNewPostCommand}" />
                            </Grid.GestureRecognizers>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Controls:CustomImage Grid.Column="0" Margin="5" Source="{Binding Image.Path}" WidthRequest="50" HeightRequest="50" Style="{StaticResource ImageHeaderStyle}">
                                <Controls:CustomImage.Transformations>
                                    <fftransformations:CircleTransformation />
                                </Controls:CustomImage.Transformations>
                            </Controls:CustomImage>
                            <Label Grid.Column="1" FontSize="12" Text="{Binding WelcomeMessage}" TextColor="{StaticResource LightTextColor}" HorizontalOptions="Start" VerticalOptions="Center" />
                            <Grid Grid.Column="2" IsVisible="{Binding IsNotBusy}" Margin="15,0">
                                <Controls:CustomImage IsVisible="{Binding IsLoggedOut}" Source="http://bit.ly/2itjhNJ" Aspect="AspectFit" Style="{StaticResource IconStyle}">
                                    <Controls:CustomImage.GestureRecognizers>
                                        <TapGestureRecognizer Command="{Binding OnLoginCommand}" />
                                    </Controls:CustomImage.GestureRecognizers>
                                </Controls:CustomImage>
                            </Grid>
                        </Grid>
                        <Grid x:Name="grdStartChallange" Margin="0,15,0,0" Grid.Row="1" RowSpacing="0" IsVisible="{Binding HasNotActiveChallenge}">
                            <Controls:CustomImage Aspect="AspectFill" Source="http://bit.ly/2gPXM5h" HorizontalOptions="FillAndExpand" VerticalOptions="FillAndExpand" />
                            <StackLayout Orientation="Vertical">
                                <Label Margin="0,5" Text="Start Your new challenge" FontSize="22" FontAttributes="Bold" HorizontalOptions="Center" TextColor="White" />
                                <Button Margin="0,0,0,5" Text="Start" Command="{Binding OnStartNewChallengeCommand}" WidthRequest="150" HorizontalOptions="Center" FontSize="14" Style="{StaticResource SecondaryButtonStyle}" />
                            </StackLayout>
                        </Grid>
                    </Grid>
                </ListView.Header>
            </ListView>
            <Controls:NavigationBar Grid.Row="2" />-->
        </Grid>
    </ContentPage.Content>
</local:BasePage>